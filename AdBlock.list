# ====================================================
# 微信全场景去广告规则（修复版）
# 修复：已移除误杀项，添加关键放行
# ====================================================

# ============ 第一部分：关键功能域名放行（必须置于顶部） ============
# 确保公众号、朋友圈等核心内容的图片、视频能正常加载
# 公众号/朋友圈图片核心域名，必须放行
HOST-SUFFIX, mmbiz.qpic.com, DIRECT
# 同类服务域名，一并放行更安全
HOST-SUFFIX, mmbiz.qpic.cn, DIRECT

# ============ 第二部分：精准广告域名拦截 ============
# 【基础广告服务】
HOST, szminorshort.weixin.qq.com, REJECT
HOST-SUFFIX, ad.weixin.qq.com, REJECT
HOST-SUFFIX, ads.wechat.com, REJECT
HOST-SUFFIX, wechatad.com, REJECT
HOST-SUFFIX, sns-ad.weixin.qq.com, REJECT
HOST-SUFFIX, mp-ad.weixin.qq.com, REJECT
HOST-SUFFIX, adinfo.weixin.qq.com, REJECT
HOST-SUFFIX, adserver.wechat.com, REJECT
HOST-SUFFIX, adsclick.weixin.qq.com, REJECT
HOST-SUFFIX, adcdn.weixin.qq.com, REJECT
HOST-SUFFIX, admicro.weixin.qq.com, REJECT
HOST-SUFFIX, adx.weixin.qq.com, REJECT
HOST-SUFFIX, wxadt.weixin.qq.com, REJECT

# 【视频号广告】
HOST-SUFFIX, finder.video.qq.com, REJECT
HOST-SUFFIX, wxapp.tc.qq.com, REJECT
HOST-SUFFIX, vweixinf.tc.qq.com, REJECT
HOST-SUFFIX, video-ads.weixin.qq.com, REJECT
HOST-SUFFIX, vd.l.qq.com, REJECT
HOST-SUFFIX, vm.gtimg.cn, REJECT

# 【腾讯广告联盟（广点通）】
HOST-SUFFIX, e.qq.com, REJECT
HOST-SUFFIX, gdt.qq.com, REJECT
HOST-SUFFIX, mi.gdt.qq.com, REJECT
HOST-SUFFIX, v.gdt.qq.com, REJECT
HOST-SUFFIX, c.gdt.qq.com, REJECT
HOST-SUFFIX, a.gdt.qq.com, REJECT
HOST-SUFFIX, pb.gdt.qq.com, REJECT
HOST-SUFFIX, mtt.e.qq.com, REJECT

# 【其他广告与追踪相关】
HOST-SUFFIX, short.weixin.qq.com, REJECT
HOST-SUFFIX, rec.weixin.qq.com, REJECT
HOST-SUFFIX, recommend.weixin.qq.com, REJECT
HOST-SUFFIX, adlog.weixin.qq.com, REJECT
HOST-SUFFIX, exposure.qq.com, REJECT
HOST-SUFFIX, report.wechat.com, REJECT
HOST-SUFFIX, adreport.qq.com, REJECT
HOST-SUFFIX, pingma.qq.com, REJECT

# ============ 第三部分：通用广告服务拦截（可能影响其他App，请知悉） ============
# 【以下域名非微信专属，拦截可能影响QQ等其他腾讯应用内广告/功能，请根据需要取舍】
# HOST-SUFFIX, c3.gtimg.com, REJECT
# HOST-SUFFIX, pgdt.gtimg.cn, REJECT
# HOST-SUFFIX, qbview.qq.com, REJECT
# HOST-SUFFIX, sngmta.qq.com, REJECT
# HOST-SUFFIX, ur.qq.com, REJECT
# HOST-SUFFIX, weishi.qq.com, REJECT
# QQ群广告，相对明确
HOST-SUFFIX, ad.qun.qq.com, REJECT
HOST-SUFFIX, adsolution-im.op.qq.com, REJECT

# 【有疑问或可能导致问题的域名】
HOST, fang-mini.xunda.qq.com, REJECT
HOST-SUFFIX, xunda.qq.com, REJECT
# HOST-KEYWORD, wechatapp, REJECT

# ============ 第四部分：广告URL路径正则匹配（动态拦截） ============
# 【通用广告路径】
URL-REGEX, ^https?://[^/]+/adreport, REJECT
URL-REGEX, ^https?://[^/]+/cgi-bin/readtemplate\?t=ad, REJECT
URL-REGEX, ^https?://[^/]+/adlog, REJECT
URL-REGEX, ^https?://[^/]+/adpos, REJECT
URL-REGEX, ^https?://[^/]+/ads/, REJECT
URL-REGEX, ^https?://[^/]+/adv/, REJECT
URL-REGEX, ^https?://[^/]+/splash/, REJECT
URL-REGEX, ^https?://[^/]+/advertisement/, REJECT
URL-REGEX, ^https?://[^/]+/sponsor/, REJECT
URL-REGEX, ^https?://[^/]+/promote/, REJECT
URL-REGEX, ^https?://[^/]+/momentad, REJECT
URL-REGEX, ^https?://[^/]+/wxad/, REJECT

# 【微信公众平台内广告路径】
URL-REGEX, ^https?://mp\.weixin\.qq\.com/mp/ad_complaint, REJECT
URL-REGEX, ^https?://mp\.weixin\.qq\.com/mp/getappmsgad, REJECT
URL-REGEX, ^https?://mp\.weixin\.qq\.com/mp/ad_video, REJECT
URL-REGEX, ^https?://mp\.weixin\.qq\.com/mp/ad, REJECT
URL-REGEX, ^https?://support\.weixin\.qq\.com/ads, REJECT

# 【朋友圈广告参数】
URL-REGEX, &adindex=, REJECT
URL-REGEX, &adpos=, REJECT
URL-REGEX, &adinfo=, REJECT

# 【朋友圈广告时间线请求】
URL-REGEX, ^https?://mp\.weixin\.qq\.com/mp/timeline.*adsense=1, REJECT
URL-REGEX, ^https?://mp\.weixin\.qq\.com/mp/homepage.*ad=1, REJECT


# ============ 第五部分：广告IP段拦截（按需启用） ============
# 【广告专用IP段】
IP-CIDR, 43.249.36.0/22, REJECT, no-resolve
IP-CIDR, 103.215.218.0/23, REJECT, no-resolve
IP-CIDR, 203.205.144.0/23, REJECT, no-resolve
IP-CIDR, 129.28.32.0/19, REJECT, no-resolve
IP-CIDR, 119.28.28.0/24, REJECT, no-resolve
IP-CIDR, 162.14.0.0/16, REJECT, no-resolve
IP-CIDR, 175.178.0.0/16, REJECT, no-resolve
IP-CIDR, 101.226.66.0/23, REJECT, no-resolve
IP-CIDR6, 2402:f000:4::/48, REJECT, no-resolve
IP-CIDR6, 2402:f000:8::/48, REJECT, no-resolve
IP-CIDR6, 2402:4e00::/32, REJECT, no-resolve


